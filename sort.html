<!DOCTYPE html>
<html lang="en">
		<head><!-- подключаем стили Mocha, для отображения результатов -->
		<meta charset="utf-8">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.css">
		<!-- подключаем библиотеку Mocha -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/2.1.0/mocha.js"></script>
		<!-- настраиваем Mocha: предстоит BDD-тестирование -->
		<script>
			mocha.setup('bdd');
		</script>
		<!-- подключаем chai -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/chai/2.0.0/chai.js"></script>
		<!-- в chai есть много всего, выносим assert в глобальную область -->
		<script>
			var assert = chai.assert;
		</script>
		<title>Title Page</title>
		<style>
		tr, td{
			border: 2px solid black;
		}

		table{
			border: 0;
			margin-top: 30px;
		}

		*{
			font-family: 'arial';
		}



		td{
			padding: 10px;
		}
		</style>
	</head>
	<body>
		<center>
			<h1 class="text-center">Sorting</h1>
			<input onkeyup="typing();" type="text" id="input" />
			<input onclick="sort();" type="submit" value="step" />
			<input onclick="reset();" type="submit" value="reset" />
			<table id="table">
				<tr id="tr">
					
				</tr>
			</table>
		</center>
		<div id="mocha"></div>

	</body>
	<script type="text/javascript">
		function check(){
			// Проверка на пробелы
			var checked = document.getElementById('input').value.replace(/  /g," ");
			checked = checked.replace(/^ /, "");
            checked = checked.replace(/([a-zA-Zа-яА-Я\!\"\№\;\%\:\?\*\(\)\_\+\-\=])/g, "");
			document.getElementById('input').value = checked;
		}

		function typing(){
			check();
			var output = '';
			var symbols = document.getElementById('input').value.split(' ');
			for (var i = 0; i < symbols.length; i++){
				output += '<td id="td_'+i+'">'+symbols[i]+'</td>';
                
				// Genius code start's here >>>
				// Проверяем на число, т.к. результатом деления неЧисла на любое чило будет NaN
				if(isNaN((symbols[i]+1/*+1 для того чтоб если был введен + или -, то дождатся следующего числа*/)/10)){
					alert('error of input data');
					document.getElementById('input').value = '';
                    document.getElementById('tr').innerHTML = '';
                    
					return;
				}
				// end of genius code >>>
                
			}
			document.getElementById('tr').innerHTML = output;
			return true;
		}
        // Массивы рисования
		for_drow = [];
		drow_back = [];
		function sort(){
			var current = document.getElementById('input').value.split(' ');
			var check = true;
			for( position = 0 ; position < current.length; position++){
				if((current[position+1] - current[position]) < 0){
					t = current[position];
					current[position] = current[position+1];
					current[position+1] = t;
					drow_back = for_drow;
					for_drow = [ position , position+1 ];
					check = false;
					document.getElementById('input').value = current.join(' ');
					break;
				}
			}
			if(check == true){
				alert('Completed');
				for (var i = 0; i < current.length; i++){
					document.getElementById('td_'+i).style.borderColor = 'green';
					document.getElementById('td_'+i).style.backgroundColor = 'green';
					document.getElementById('td_'+i).style.color = 'white';
				}
				return;
			}
			output = '';
			for(i = 0; i < current.length; i++){
				output += '<td id="td_'+i+'">'+current[i]+'</td>';
				document.getElementById('tr').innerHTML = output;	
			}
			if (drow_back.length == 2){
				document.getElementById('td_'+drow_back[0]).style.backgroundColor = 'yellow';
				document.getElementById('td_'+drow_back[1]).style.backgroundColor = 'yellow';
			}
			document.getElementById('td_'+for_drow[0]).style.borderColor = 'red';
			document.getElementById('td_'+for_drow[1]).style.borderColor = 'red';	
			document.getElementById('td_'+for_drow[0]).style.backgroundColor = 'red';
			document.getElementById('td_'+for_drow[1]).style.backgroundColor = 'red';
			 if (drow_back.length == 2){
				document.getElementById('td_'+drow_back[0]).style.borderColor = 'yellow';
				document.getElementById('td_'+drow_back[1]).style.borderColor = 'yellow';
			}	
		}

		function reset(){
			document.getElementById('input').value = '';
			document.getElementById('tr').innerHTML = '';
		}

        
		//functions for test
		function sort_test(arr){
			current = arr;
			for( var position = 0 ; position < current.length; position++){
				if((current[position+1] - current[position]) < 0){
					t = current[position];
					current[position] = current[position+1];
					current[position+1] = t;
					break;
				}
			}
			return current.join(',');	
		}
	</script>
	<script src="test.js"></script>
	<script>
    	mocha.run();
  	</script>
</html>